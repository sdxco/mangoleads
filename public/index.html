<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MangoLeads CRM - Professional Dashboard</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        .gradient-bg {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        .glass-effect {
            backdrop-filter: blur(16px);
            background: rgba(255, 255, 255, 0.95);
            border: 1px solid rgba(255, 255, 255, 0.18);
        }
        .tab-btn.active {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white !important;
            border-radius: 8px;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);
        }
        .status-queued { 
            background: linear-gradient(135deg, #fbbf24, #f59e0b); 
            color: white; 
            padding: 4px 12px; 
            border-radius: 20px; 
            font-size: 12px; 
            font-weight: 600;
        }
        .status-sent { 
            background: linear-gradient(135deg, #10b981, #059669); 
            color: white; 
            padding: 4px 12px; 
            border-radius: 20px; 
            font-size: 12px; 
            font-weight: 600;
        }
        .status-failed { 
            background: linear-gradient(135deg, #ef4444, #dc2626); 
            color: white; 
            padding: 4px 12px; 
            border-radius: 20px; 
            font-size: 12px; 
            font-weight: 600;
        }
        .status-processing { 
            background: linear-gradient(135deg, #3b82f6, #2563eb); 
            color: white; 
            padding: 4px 12px; 
            border-radius: 20px; 
            font-size: 12px; 
            font-weight: 600;
        }
        .brand-card {
            transition: all 0.3s ease;
            border-radius: 16px;
            overflow: hidden;
        }
        .brand-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
        }
        .brand-active {
            background: linear-gradient(135deg, #10b981, #059669);
            color: white;
        }
        .brand-inactive {
            background: linear-gradient(135deg, #6b7280, #4b5563);
            color: white;
        }
        .stats-card {
            background: linear-gradient(135deg, rgba(255,255,255,0.9), rgba(255,255,255,0.7));
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255,255,255,0.2);
            border-radius: 20px;
            transition: all 0.3s ease;
        }
        .stats-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
        }
        .main-container {
            min-height: 100vh;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        .content-wrapper {
            background: rgba(255,255,255,0.95);
            backdrop-filter: blur(20px);
            border-radius: 24px;
            margin: 20px;
            box-shadow: 0 25px 50px rgba(0,0,0,0.1);
        }
    </style>
</head>
<body class="main-container">
    <!-- Header -->
    <header class="glass-effect border-b border-white/20">
        <div class="max-w-7xl mx-auto px-6 lg:px-8">
            <div class="flex justify-between items-center py-6">
                <div class="flex items-center">
                    <div class="w-12 h-12 rounded-full gradient-bg flex items-center justify-center mr-4">
                        <span class="text-2xl">ðŸ¥­</span>
                    </div>
                    <div>
                        <h1 class="text-2xl font-bold text-gray-900">MangoLeads CRM</h1>
                        <p class="text-sm text-gray-600">Professional Lead Management</p>
                    </div>
                </div>
                <div class="flex items-center space-x-4">
                    <button onclick="refreshData()" class="p-3 rounded-full bg-white shadow-lg hover:shadow-xl transition-all duration-300 text-gray-600 hover:text-purple-600">
                        <i class="fas fa-sync-alt"></i>
                    </button>
                    <div class="flex items-center space-x-3 bg-white rounded-full px-4 py-2 shadow-lg">
                        <div class="w-8 h-8 gradient-bg rounded-full flex items-center justify-center">
                            <i class="fas fa-user text-white text-sm"></i>
                        </div>
                        <span class="font-medium text-gray-700">Admin</span>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <div class="content-wrapper">
        
        <!-- Stats Cards -->
        <div class="grid grid-cols-1 md:grid-cols-3 gap-8 p-8 mb-4">
            <div class="stats-card p-8">
                <div class="flex items-center justify-between">
                    <div>
                        <p class="text-sm font-medium text-gray-600 mb-1">Total Leads</p>
                        <p class="text-3xl font-bold text-gray-900" id="total-leads">0</p>
                        <p class="text-sm text-green-600 mt-1">
                            <i class="fas fa-arrow-up mr-1"></i>+12% from last month
                        </p>
                    </div>
                    <div class="w-16 h-16 rounded-full bg-blue-100 flex items-center justify-center">
                        <i class="fas fa-users text-blue-600 text-2xl"></i>
                    </div>
                </div>
            </div>
            
            <div class="stats-card p-8">
                <div class="flex items-center justify-between">
                    <div>
                        <p class="text-sm font-medium text-gray-600 mb-1">Successful Conversions</p>
                        <p class="text-3xl font-bold text-gray-900" id="sent-leads">0</p>
                        <p class="text-sm text-green-600 mt-1">
                            <i class="fas fa-arrow-up mr-1"></i>+8% conversion rate
                        </p>
                    </div>
                    <div class="w-16 h-16 rounded-full bg-green-100 flex items-center justify-center">
                        <i class="fas fa-check-circle text-green-600 text-2xl"></i>
                    </div>
                </div>
            </div>
            
            <div class="stats-card p-8">
                <div class="flex items-center justify-between">
                    <div>
                        <p class="text-sm font-medium text-gray-600 mb-1">Active Brands</p>
                        <p class="text-3xl font-bold text-gray-900" id="active-brands">0</p>
                        <p class="text-sm text-purple-600 mt-1">
                            <i class="fas fa-building mr-1"></i>Management ready
                        </p>
                    </div>
                    <div class="w-16 h-16 rounded-full bg-purple-100 flex items-center justify-center">
                        <i class="fas fa-building text-purple-600 text-2xl"></i>
                    </div>
                </div>
            </div>
        </div>

        <!-- Tabs -->
        <div class="px-8">
            <div class="border-b border-gray-200 mb-8">
                <nav class="flex space-x-1" id="tab-nav">
                    <button class="tab-btn active px-6 py-3 text-gray-500 hover:text-gray-700 font-medium text-sm transition-all duration-300" data-tab="leads">
                        <i class="fas fa-users mr-2"></i>Leads Management
                    </button>
                    <button class="tab-btn px-6 py-3 text-gray-500 hover:text-gray-700 font-medium text-sm transition-all duration-300" data-tab="brands">
                        <i class="fas fa-building mr-2"></i>Brands Management
                    </button>
                    <button class="tab-btn px-6 py-3 text-gray-500 hover:text-gray-700 font-medium text-sm transition-all duration-300" data-tab="analytics">
                        <i class="fas fa-chart-bar mr-2"></i>Analytics & Reports
                    </button>
                </nav>
            </div>

            <!-- Leads Tab -->
            <div id="leads-tab" class="tab-content pb-8">
                <div class="flex justify-between items-center mb-6">
                    <div>
                        <h3 class="text-2xl font-bold text-gray-900">Leads Management</h3>
                        <p class="text-gray-600 mt-1">Manage and track your leads efficiently</p>
                    </div>
                    <button class="gradient-bg hover:opacity-90 text-white px-6 py-3 rounded-xl text-sm font-medium transition-all duration-300 shadow-lg hover:shadow-xl" onclick="refreshLeads()">
                        <i class="fas fa-sync-alt mr-2"></i>Refresh Data
                    </button>
                </div>
                
                <div class="bg-white rounded-2xl shadow-xl overflow-hidden">
                    <div class="overflow-x-auto">
                        <table class="min-w-full divide-y divide-gray-200">
                            <thead class="bg-gray-50">
                                <tr>
                                    <th class="px-6 py-4 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider">Name</th>
                                    <th class="px-6 py-4 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider">Contact</th>
                                    <th class="px-6 py-4 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider">Brand</th>
                                    <th class="px-6 py-4 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider">Status</th>
                                    <th class="px-6 py-4 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider">Date Created</th>
                                    <th class="px-6 py-4 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider">Actions</th>
                                </tr>
                            </thead>
                            <tbody id="leads-table" class="bg-white divide-y divide-gray-200">
                                <tr>
                                    <td colspan="6" class="px-6 py-12 text-center text-gray-500">
                                        <i class="fas fa-spinner fa-spin text-2xl mb-4"></i>
                                        <p>Loading leads...</p>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Brands Tab -->
            <div id="brands-tab" class="tab-content pb-8 hidden">
                <div class="flex justify-between items-center mb-6">
                    <div>
                        <h3 class="text-2xl font-bold text-gray-900">Brands Management</h3>
                        <p class="text-gray-600 mt-1">Manage your brand configurations and status</p>
                    </div>
                </div>
                
                <div id="brands-list" class="grid grid-cols-1 gap-6">
                    <div class="text-center text-gray-500 py-12">
                        <i class="fas fa-spinner fa-spin text-2xl mb-4"></i>
                        <p>Loading brands...</p>
                    </div>
                </div>
            </div>

            <!-- API Integration Tab -->
            <div id="api-integration-tab" class="tab-content p-6 hidden">
                <h3 class="text-lg font-medium text-gray-900 mb-6">API Integration & Testing</h3>
                
                <div class="grid md:grid-cols-2 gap-6">
                    <!-- Test Lead Submission Form -->
                    <div class="bg-gray-50 rounded-lg p-6">
                        <h4 class="text-md font-semibold mb-4">Test Lead Submission</h4>
                        <form id="testForm" class="space-y-4">
                            <div class="grid grid-cols-2 gap-4">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">First Name</label>
                                    <input type="text" id="test_first_name" name="first_name" required 
                                           class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">Last Name</label>
                                    <input type="text" id="test_last_name" name="last_name" required
                                           class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                                </div>
                            </div>
                            
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Email</label>
                                <input type="email" id="test_email" name="email" required
                                       class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                            </div>
                            
                            <div class="grid grid-cols-2 gap-4">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">Phone CC</label>
                                    <input type="text" id="test_phonecc" name="phonecc" value="+1" required
                                           class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">Phone</label>
                                    <input type="text" id="test_phone" name="phone" required
                                           class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                                </div>
                            </div>
                            
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Country</label>
                                <select id="test_country" name="country" required
                                        class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                                    <option value="US">United States</option>
                                    <option value="CA">Canada</option>
                                    <option value="GB">United Kingdom</option>
                                    <option value="DE">Germany</option>
                                    <option value="FR">France</option>
                                    <option value="IT">Italy</option>
                                    <option value="ES">Spain</option>
                                    <option value="AU">Australia</option>
                                </select>
                            </div>
                            
                            <div class="grid grid-cols-2 gap-4">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">Brand ID</label>
                                    <input type="text" id="test_brand_id" name="brand_id" value="1000" required
                                           class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">Brand Name</label>
                                    <input type="text" id="test_brand_name" name="brand_name" value="Mock Trading Test" required
                                           class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                                </div>
                            </div>
                            
                            <div class="grid grid-cols-2 gap-4">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">Aff ID</label>
                                    <input type="text" id="test_aff_id" name="aff_id" value="28215" required
                                           class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">Offer ID</label>
                                    <input type="text" id="test_offer_id" name="offer_id" value="1000" required
                                           class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                                </div>
                            </div>
                            
                            <button type="submit" 
                                    class="w-full bg-blue-600 text-white py-2 px-4 rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500">
                                Submit Test Lead
                            </button>
                        </form>
                        
                        <div id="testResult" class="mt-4 hidden">
                            <div class="p-3 rounded-md">
                                <p id="testMessage"></p>
                            </div>
                        </div>
                    </div>
                    
                    <!-- API Documentation -->
                    <div class="bg-gray-50 rounded-lg p-6">
                        <h4 class="text-md font-semibold mb-4">API Documentation</h4>
                        
                        <div class="space-y-4">
                            <div>
                                <h5 class="font-medium text-gray-900">Endpoint:</h5>
                                <code class="bg-gray-200 px-2 py-1 rounded text-sm">POST /api/leads</code>
                            </div>
                            
                            <div>
                                <h5 class="font-medium text-gray-900">Required Fields:</h5>
                                <ul class="list-disc list-inside text-sm text-gray-600 mt-2">
                                    <li>first_name (string, max 50)</li>
                                    <li>last_name (string, max 50)</li>
                                    <li>email (string, valid email)</li>
                                    <li>phonecc (string, country code)</li>
                                    <li>phone (string, max 14)</li>
                                    <li>country (string, 2-char code)</li>
                                    <li>brand_id (string, max 50)</li>
                                    <li>brand_name (string, max 100)</li>
                                    <li>aff_id (string, max 20)</li>
                                    <li>offer_id (string, max 10)</li>
                                </ul>
                            </div>
                            
                            <div>
                                <h5 class="font-medium text-gray-900">Example Request:</h5>
                                <pre class="bg-gray-200 p-3 rounded text-xs overflow-x-auto"><code>{
  "first_name": "John",
  "last_name": "Doe", 
  "email": "john@example.com",
  "phonecc": "+1",
  "phone": "1234567890",
  "country": "US",
  "brand_id": "1000",
  "brand_name": "Mock Trading Test",
  "aff_id": "28215",
  "offer_id": "1000"
}</code></pre>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Analytics Tab -->
            <div id="analytics-tab" class="tab-content pb-8 hidden">
                <div class="flex justify-between items-center mb-6">
                    <div>
                        <h3 class="text-2xl font-bold text-gray-900">Analytics & Reports</h3>
                        <p class="text-gray-600 mt-1">Track performance and insights</p>
                    </div>
                    <button onclick="refreshAnalytics()" class="gradient-bg hover:opacity-90 text-white px-6 py-3 rounded-xl text-sm font-medium transition-all duration-300 shadow-lg hover:shadow-xl">
                        <i class="fas fa-sync-alt mr-2"></i>Refresh Analytics
                    </button>
                </div>
                
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                    <!-- Performance Overview -->
                    <div class="bg-white rounded-2xl shadow-xl p-8">
                        <h4 class="text-lg font-semibold text-gray-900 mb-6">Performance Overview</h4>
                        <div class="space-y-6">
                            <div class="flex justify-between items-center">
                                <span class="text-gray-600">Conversion Rate</span>
                                <span class="text-2xl font-bold text-green-600">68.5%</span>
                            </div>
                            <div class="w-full bg-gray-200 rounded-full h-2">
                                <div class="bg-gradient-to-r from-green-400 to-green-600 h-2 rounded-full" style="width: 68.5%"></div>
                            </div>
                            
                            <div class="flex justify-between items-center">
                                <span class="text-gray-600">Success Rate</span>
                                <span class="text-2xl font-bold text-blue-600">85.2%</span>
                            </div>
                            <div class="w-full bg-gray-200 rounded-full h-2">
                                <div class="bg-gradient-to-r from-blue-400 to-blue-600 h-2 rounded-full" style="width: 85.2%"></div>
                            </div>
                            
                            <div class="flex justify-between items-center">
                                <span class="text-gray-600">Brand Activity</span>
                                <span class="text-2xl font-bold text-purple-600">100%</span>
                            </div>
                            <div class="w-full bg-gray-200 rounded-full h-2">
                                <div class="bg-gradient-to-r from-purple-400 to-purple-600 h-2 rounded-full" style="width: 100%"></div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Recent Activity -->
                    <div class="bg-white rounded-2xl shadow-xl p-8">
                        <h4 class="text-lg font-semibold text-gray-900 mb-6">Recent Activity</h4>
                        <div class="space-y-4" id="recent-activity">
                            <div class="flex items-center space-x-3">
                                <div class="w-2 h-2 bg-green-500 rounded-full"></div>
                                <span class="text-sm text-gray-600">New lead processed successfully</span>
                                <span class="text-xs text-gray-400 ml-auto">2 min ago</span>
                            </div>
                            <div class="flex items-center space-x-3">
                                <div class="w-2 h-2 bg-blue-500 rounded-full"></div>
                                <span class="text-sm text-gray-600">Brand status updated</span>
                                <span class="text-xs text-gray-400 ml-auto">5 min ago</span>
                            </div>
                            <div class="flex items-center space-x-3">
                                <div class="w-2 h-2 bg-purple-500 rounded-full"></div>
                                <span class="text-sm text-gray-600">System health check completed</span>
                                <span class="text-xs text-gray-400 ml-auto">10 min ago</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Tab Management
        function showTab(tabName) {
            // Hide all tabs
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.add('hidden');
            });
            
            // Remove active class from all buttons
            document.querySelectorAll('.tab-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            
            // Show selected tab
            document.getElementById(tabName + '-tab').classList.remove('hidden');
            
            // Add active class to clicked button
            document.querySelector(`[data-tab="${tabName}"]`).classList.add('active');
        }

        // Event listeners for tabs
        document.addEventListener('DOMContentLoaded', function() {
            document.querySelectorAll('.tab-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const tabName = this.getAttribute('data-tab');
                    showTab(tabName);
                });
            });
            
            // Load initial data
            refreshData();
        });

        // Data Management Functions
        async function refreshData() {
            try {
                await Promise.all([
                    refreshLeads(),
                    refreshBrands(),
                    refreshStats()
                ]);
            } catch (error) {
                console.error('Error refreshing data:', error);
            }
        }

        async function refreshStats() {
            try {
                const response = await fetch('/api/stats');
                const stats = await response.json();
                
                document.getElementById('total-leads').textContent = stats.total || 0;
                document.getElementById('sent-leads').textContent = stats.sent || 0;
                document.getElementById('active-brands').textContent = stats.active_brands || 0;
            } catch (error) {
                console.error('Error loading stats:', error);
            }
        }

        async function refreshLeads() {
            try {
                const response = await fetch('/api/leads');
                const data = await response.json();
                
                const tableBody = document.getElementById('leads-table');
                
                if (data.leads && data.leads.length > 0) {
                    tableBody.innerHTML = data.leads.map(lead => `
                        <tr class="hover:bg-gray-50 transition-colors duration-200">
                            <td class="px-6 py-4">
                                <div class="font-medium text-gray-900">${lead.firstName || ''} ${lead.lastName || ''}</div>
                            </td>
                            <td class="px-6 py-4">
                                <div class="text-sm text-gray-900">${lead.email || ''}</div>
                                <div class="text-sm text-gray-500">${lead.phone || ''}</div>
                            </td>
                            <td class="px-6 py-4">
                                <span class="inline-flex items-center px-3 py-1 rounded-full text-xs font-medium bg-purple-100 text-purple-800">
                                    ${lead.brand || 'Unknown'}
                                </span>
                            </td>
                            <td class="px-6 py-4">
                                <span class="status-${lead.status || 'queued'}">${lead.status || 'queued'}</span>
                            </td>
                            <td class="px-6 py-4 text-sm text-gray-500">
                                ${lead.created_at ? new Date(lead.created_at).toLocaleDateString() : ''}
                            </td>
                            <td class="px-6 py-4">
                                <button onclick="viewLead(${lead.id})" class="text-blue-600 hover:text-blue-900 text-sm font-medium">
                                    <i class="fas fa-eye mr-1"></i>View
                                </button>
                            </td>
                        </tr>
                    `).join('');
                } else {
                    tableBody.innerHTML = `
                        <tr>
                            <td colspan="6" class="px-6 py-12 text-center text-gray-500">
                                <i class="fas fa-inbox text-3xl mb-4"></i>
                                <p>No leads found</p>
                            </td>
                        </tr>
                    `;
                }
            } catch (error) {
                console.error('Error loading leads:', error);
                document.getElementById('leads-table').innerHTML = `
                    <tr>
                        <td colspan="6" class="px-6 py-12 text-center text-red-500">
                            <i class="fas fa-exclamation-triangle text-2xl mb-4"></i>
                            <p>Error loading leads</p>
                        </td>
                    </tr>
                `;
            }
        }

        async function refreshBrands() {
            try {
                const response = await fetch('/brands');
                const brands = await response.json();
                
                const brandsList = document.getElementById('brands-list');
                
                if (brands && brands.length > 0) {
                    brandsList.innerHTML = brands.map(brand => `
                        <div class="brand-card bg-white rounded-2xl shadow-xl p-8">
                            <div class="flex justify-between items-start mb-6">
                                <div>
                                    <h4 class="text-xl font-bold text-gray-900 mb-2">${brand.name}</h4>
                                    <p class="text-gray-600">Brand ID: ${brand.id}</p>
                                </div>
                                <div class="flex items-center">
                                    <label class="relative inline-flex items-center cursor-pointer">
                                        <input type="checkbox" class="sr-only peer" ${brand.active ? 'checked' : ''} 
                                               onchange="toggleBrand('${brand.id}', this.checked)">
                                        <div class="w-14 h-7 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-purple-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-0.5 after:left-[4px] after:bg-white after:rounded-full after:h-6 after:w-6 after:transition-all peer-checked:bg-gradient-to-r peer-checked:from-purple-500 peer-checked:to-purple-600"></div>
                                    </label>
                                </div>
                            </div>
                            
                            <div class="space-y-3">
                                <div class="flex justify-between items-center">
                                    <span class="text-gray-600">Status</span>
                                    <span class="${brand.active ? 'brand-active' : 'brand-inactive'} px-3 py-1 rounded-full text-xs font-medium">
                                        ${brand.active ? 'Active' : 'Inactive'}
                                    </span>
                                </div>
                                
                                <div class="flex justify-between items-center">
                                    <span class="text-gray-600">Type</span>
                                    <span class="text-gray-900 font-medium">${brand.type || 'Standard'}</span>
                                </div>
                                
                                ${brand.trackerUrl ? `
                                <div class="mt-4 p-3 bg-gray-50 rounded-lg">
                                    <p class="text-xs text-gray-600">Tracker URL:</p>
                                    <p class="text-xs text-gray-800 break-all">${brand.trackerUrl}</p>
                                </div>
                                ` : ''}
                            </div>
                        </div>
                    `).join('');
                } else {
                    brandsList.innerHTML = `
                        <div class="col-span-full text-center py-12">
                            <i class="fas fa-building text-4xl text-gray-300 mb-4"></i>
                            <p class="text-gray-500 text-lg">No brands configured</p>
                        </div>
                    `;
                }
            } catch (error) {
                console.error('Error loading brands:', error);
                document.getElementById('brands-list').innerHTML = `
                    <div class="col-span-full text-center py-12 text-red-500">
                        <i class="fas fa-exclamation-triangle text-3xl mb-4"></i>
                        <p>Error loading brands</p>
                    </div>
                `;
            }
        }

        async function toggleBrand(brandId, isActive) {
            try {
                const response = await fetch(`/brands/${brandId}/toggle`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ active: isActive })
                });
                
                if (response.ok) {
                    refreshBrands();
                    refreshStats();
                } else {
                    throw new Error('Failed to toggle brand status');
                }
            } catch (error) {
                console.error('Error toggling brand:', error);
                alert('Failed to update brand status');
                refreshBrands(); // Revert the toggle
            }
        }

        function viewLead(leadId) {
            // Simple lead view functionality
            alert(`Lead ID: ${leadId}\nFull lead details would be shown in a modal here.`);
        }

        async function refreshAnalytics() {
            // Refresh analytics data
            console.log('Refreshing analytics...');
        }
    </script>
</body>
</html>
                        <h4 class="text-md font-semibold text-gray-900 mb-4">Leads by Brand</h4>
                        <div style="height: 300px;">
                            <canvas id="brand-chart"></canvas>
                        </div>
                    </div>
                    
                    <!-- Status Distribution -->
                    <div class="bg-white border rounded-lg p-6">
                        <h4 class="text-md font-semibold text-gray-900 mb-4">Status Distribution</h4>
                        <div style="height: 300px;">
                            <canvas id="status-chart"></canvas>
                        </div>
                    </div>
                </div>

                <!-- Brand Stats Table -->
                <div class="bg-white border rounded-lg p-6">
                    <h4 class="text-md font-semibold text-gray-900 mb-4">Brand Performance Details</h4>
                    <div class="overflow-x-auto">
                        <table class="min-w-full divide-y divide-gray-200">
                            <thead class="bg-gray-50">
                                <tr>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Brand</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Total Leads</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Success Rate</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Sent</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Errors</th>
                                </tr>
                            </thead>
                            <tbody id="brand-stats-table" class="bg-white divide-y divide-gray-200">
                                <tr>
                                    <td colspan="5" class="px-6 py-4 text-center text-gray-500">
                                        Loading analytics...
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="dashboard.js"></script>
</body>
</html>
